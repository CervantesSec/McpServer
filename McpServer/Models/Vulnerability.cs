using System.Text.Json.Serialization;

namespace McpServer.Models;

public class Vuln
{
    [JsonPropertyName("id")]
    public Guid Id { get; set; }
    
    [JsonPropertyName("name")]
    public string Name { get; set; } = string.Empty;
    
    [JsonPropertyName("template")]
    public bool Template { get; set; }
    
    [JsonPropertyName("language")]
    public Language Language { get; set; }
    
    [JsonPropertyName("vulnCategoryId")]
    public Guid VulnCategoryId { get; set; }
    
    [JsonPropertyName("vulnCategory")]
    public VulnCategory? VulnCategory { get; set; }
    
    [JsonPropertyName("vulnCweId")]
    public Guid? VulnCweId { get; set; }
    
    [JsonPropertyName("vulnCwe")]
    public VulnCwe? VulnCwe { get; set; }
    
    [JsonPropertyName("risk")]
    public VulnRisk Risk { get; set; }
    
    [JsonPropertyName("status")]
    public VulnStatus Status { get; set; }
    
    [JsonPropertyName("findingId")]
    public string? FindingId { get; set; }
    
    [JsonPropertyName("impact")]
    public string? Impact { get; set; }
    
    [JsonPropertyName("description")]
    public string? Description { get; set; }
    
    [JsonPropertyName("proofOfConcept")]
    public string? ProofOfConcept { get; set; }
    
    [JsonPropertyName("remediation")]
    public string? Remediation { get; set; }
    
    [JsonPropertyName("remediationComplexity")]
    public RemediationComplexity RemediationComplexity { get; set; }
    
    [JsonPropertyName("remediationPriority")]
    public RemediationPriority RemediationPriority { get; set; }
    
    [JsonPropertyName("cvss3")]
    public double Cvss3 { get; set; }
    
    [JsonPropertyName("cvsScore")]
    public string? CvsScore { get; set; }
    
    [JsonPropertyName("owaspRisk")]
    public string? OwaspRisk { get; set; }
    
    [JsonPropertyName("owaspImpact")]
    public string? OwaspImpact { get; set; }
    
    [JsonPropertyName("owaspLikehood")]
    public string? OwaspLikehood { get; set; }
    
    [JsonPropertyName("owaspVector")]
    public string? OwaspVector { get; set; }
    
    [JsonPropertyName("jiraCreated")]
    public bool JiraCreated { get; set; }
    
    [JsonPropertyName("projectId")]
    public Guid ProjectId { get; set; }
    
    [JsonPropertyName("project")]
    public Project? Project { get; set; }
    
    [JsonPropertyName("userId")]
    public string? UserId { get; set; }
    
    [JsonPropertyName("createdDate")]
    public DateTime CreatedDate { get; set; }
}

public class VulnCreateViewModel
{
    [JsonPropertyName("name")]
    public string Name { get; set; } = string.Empty;
    
    [JsonPropertyName("template")]
    public bool Template { get; set; }
    
    [JsonPropertyName("language")]
    public Language Language { get; set; }
    
    [JsonPropertyName("vulnCategoryId")]
    public Guid VulnCategoryId { get; set; }
    
    [JsonPropertyName("vulnCweId")]
    public Guid? VulnCweId { get; set; }
    
    [JsonPropertyName("risk")]
    public VulnRisk Risk { get; set; }
    
    [JsonPropertyName("status")]
    public VulnStatus Status { get; set; }
    
    [JsonPropertyName("impact")]
    public string? Impact { get; set; }
    
    [JsonPropertyName("description")]
    public string? Description { get; set; }
    
    [JsonPropertyName("proofOfConcept")]
    public string? ProofOfConcept { get; set; }
    
    [JsonPropertyName("remediation")]
    public string? Remediation { get; set; }
    
    [JsonPropertyName("remediationComplexity")]
    public RemediationComplexity RemediationComplexity { get; set; }
    
    [JsonPropertyName("remediationPriority")]
    public RemediationPriority RemediationPriority { get; set; }
    
    [JsonPropertyName("projectId")]
    public Guid ProjectId { get; set; }
}

public class VulnCategory
{
    [JsonPropertyName("id")]
    public Guid Id { get; set; }
    
    [JsonPropertyName("name")]
    public string Name { get; set; } = string.Empty;
    
    [JsonPropertyName("description")]
    public string? Description { get; set; }
    
    [JsonPropertyName("type")]
    public VulnCategoryType Type { get; set; }
}

public class VulnCwe
{
    [JsonPropertyName("id")]
    public Guid Id { get; set; }
    
    [JsonPropertyName("cweId")]
    public int CweId { get; set; }
    
    [JsonPropertyName("name")]
    public string Name { get; set; } = string.Empty;
    
    [JsonPropertyName("description")]
    public string? Description { get; set; }
}

public enum VulnRisk
{
    Info = 0,
    Low = 1,
    Medium = 2,
    High = 3,
    Critical = 4
}

public enum VulnStatus
{
    Open = 0,
    Confirmed = 1,
    Resolved = 2,
    OutOfScope = 3,
    Accepted = 4,
    Invalid = 5
}

public enum RemediationComplexity
{
    High = 0,
    Medium = 1,
    Low = 2
}

public enum RemediationPriority
{
    High = 0,
    Medium = 1,
    Low = 2
}

public enum VulnCategoryType
{
    OWASP = 0,
    SANS = 1,
    Custom = 2
}

// Vulnerability Notes ViewModels
public class VulnNoteViewModel
{
    [JsonPropertyName("vulnId")]
    public Guid VulnId { get; set; }
    
    [JsonPropertyName("name")]
    public string Name { get; set; } = string.Empty;
    
    [JsonPropertyName("description")]
    public string? Description { get; set; }
    
    [JsonPropertyName("visibility")]
    public Visibility Visibility { get; set; }
}

public class VulnNoteEditViewModel
{
    [JsonPropertyName("id")]
    public Guid Id { get; set; }
    
    [JsonPropertyName("name")]
    public string Name { get; set; } = string.Empty;
    
    [JsonPropertyName("description")]
    public string? Description { get; set; }
    
    [JsonPropertyName("visibility")]
    public Visibility Visibility { get; set; }
}

// Vulnerability Targets ViewModels
public class VulnTargetViewModel
{
    [JsonPropertyName("vulnId")]
    public Guid VulnId { get; set; }
    
    [JsonPropertyName("targetId")]
    public Guid TargetId { get; set; }
}

// Vulnerability Attachments ViewModels
public class VulnAttachmentViewModel
{
    [JsonPropertyName("vulnId")]
    public Guid VulnId { get; set; }
    
    [JsonPropertyName("name")]
    public string Name { get; set; } = string.Empty;
    
    [JsonPropertyName("fileName")]
    public string? FileName { get; set; }
    
    [JsonPropertyName("fileContent")]
    public byte[]? FileContent { get; set; }
}

// Vulnerability Category Management ViewModels
public class VulnCategoryCreate
{
    [JsonPropertyName("name")]
    public string Name { get; set; } = string.Empty;
    
    [JsonPropertyName("description")]
    public string? Description { get; set; }
    
    [JsonPropertyName("type")]
    public VulnCategoryType Type { get; set; }
}

public class VulnCategoryEdit
{
    [JsonPropertyName("id")]
    public Guid Id { get; set; }
    
    [JsonPropertyName("name")]
    public string Name { get; set; } = string.Empty;
    
    [JsonPropertyName("description")]
    public string? Description { get; set; }
    
    [JsonPropertyName("type")]
    public VulnCategoryType Type { get; set; }
}